<!DOCTYPE html>
<html class="dark" lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ video.title }} - WOOVB</title>
    <link rel="icon" type="image/jpeg" href="{{ url_for('static', filename='img/logo.jpg') }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Spline+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://vjs.zencdn.net/8.6.1/video-js.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: "#9b87f5",
                        "primary-dark": "#7c3aed",
                        "background-dark": "#1a1530",
                    },
                    fontFamily: { display: ["Spline Sans"] },
                },
            },
        };
    </script>
    <style>
        .video-js {
            width: 100%;
            height: auto;
        }
        .video-js .vjs-big-play-button {
            background-color: rgba(155, 135, 245, 0.9);
            border: none;
            border-radius: 50%;
            width: 80px;
            height: 80px;
            font-size: 48px;
            line-height: 80px;
        }
        .video-js .vjs-control-bar {
            background: rgba(26, 21, 48, 0.9);
            backdrop-filter: blur(10px);
        }
        .video-js .vjs-play-progress {
            background-color: #9b87f5;
        }
    </style>
</head>
<body class="font-display bg-background-dark text-white">
    <!-- Unified Header -->
    <header class="border-b border-white/10 px-10 py-4 sticky top-0 bg-background-dark/95 backdrop-blur-lg z-50">
        <div class="flex items-center justify-between">
            <a href="{{ url_for('home') }}" class="flex items-center gap-3 hover:opacity-80 transition-opacity">
                <img src="{{ url_for('static', filename='img/logo.jpg') }}" alt="WOOVB" class="h-10 w-10 rounded-lg">
                <h1 class="text-xl font-bold text-white">WOOVB</h1>
            </a>
            <nav class="hidden md:flex items-center gap-8">
                <a href="{{ url_for('home') }}" class="text-sm font-medium text-white/60 hover:text-white transition-colors">Home</a>
                <a href="{{ url_for('dashboard') }}" class="text-sm font-medium text-white/60 hover:text-white transition-colors">My Videos</a>
                <a href="{{ url_for('upload_page') }}" class="text-sm font-medium text-white/60 hover:text-white transition-colors">Upload</a>
                <a href="{{ url_for('videos') }}" class="text-sm font-medium text-white/60 hover:text-white transition-colors">Browse All</a>
            </nav>
            <div class="flex items-center gap-4">
                <div class="size-10 rounded-full bg-primary flex items-center justify-center text-white font-bold">
                    {{ session.username[0].upper() }}
                </div>
                <a href="{{ url_for('logout') }}" class="text-sm font-medium text-white/60 hover:text-white transition-colors">Logout</a>
            </div>
        </div>
    </header>

    <main class="max-w-6xl mx-auto px-4 py-8 sm:px-6 lg:px-8">
        <!-- Video Player -->
        <div class="bg-black rounded-2xl overflow-hidden mb-6 border-2 border-primary/30 shadow-2xl shadow-primary/20">
            <video 
                id="videoPlayer" 
                class="video-js vjs-big-play-centered"
                controls
                preload="auto"
                data-setup='{"fluid": true, "aspectRatio": "16:9"}'>
                <source src="{{ url_for('serve_video', filename=video.filename) }}" type="video/mp4">
                Your browser does not support the video tag.
            </video>
        </div>

        <!-- Video Details -->
        <div class="bg-white/5 backdrop-blur-lg rounded-2xl p-8 border border-white/10 mb-6">
            <h1 class="text-3xl font-bold mb-4 bg-gradient-to-r from-primary to-purple-400 bg-clip-text text-transparent">
                {{ video.title }}
            </h1>

            <div class="flex flex-wrap gap-4 mb-6">
                <div class="px-4 py-2 bg-primary/20 rounded-lg border border-primary/30">
                    <span class="text-sm font-semibold">ID: {{ video.video_id }}</span>
                </div>
                <div class="px-4 py-2 bg-white/5 rounded-lg">
                    <span class="text-sm font-semibold">{{ video.views }} views</span>
                </div>
                <div class="px-4 py-2 bg-white/5 rounded-lg">
                    <span class="text-sm font-semibold">{{ video.created_at[:19] }}</span>
                </div>
            </div>

            <div class="flex items-center gap-4 p-4 bg-primary/10 rounded-xl border border-primary/20">
                <div class="size-14 rounded-full bg-gradient-to-br from-primary to-purple-500 flex items-center justify-center text-white font-bold text-xl shadow-lg">
                    {{ video.username[0].upper() }}
                </div>
                <div>
                    <h3 class="font-bold text-lg">{{ video.username }}</h3>
                    <p class="text-sm text-white/60">Content Creator</p>
                </div>
            </div>

            {% if video.description %}
            <div class="mt-6 pt-6 border-t border-white/10">
                <h3 class="font-bold text-lg mb-3">Description</h3>
                <p class="text-white/70 leading-relaxed">{{ video.description }}</p>
            </div>
            {% endif %}
        </div>

        <!-- Back Button -->
        <a href="{{ url_for('videos') }}" class="inline-flex items-center gap-2 px-6 py-3 bg-white/5 hover:bg-white/10 rounded-full transition-colors border border-white/10">
            <span class="font-semibold">Back to Videos</span>
        </a>
    </main>

    <script src="https://vjs.zencdn.net/8.6.1/video.min.js"></script>
    <script>
        // Initialize Video.js player
        var player = videojs('videoPlayer', {
            controls: true,
            autoplay: false,
            preload: 'auto',
            playbackRates: [0.5, 0.75, 1, 1.25, 1.5, 2],
            controlBar: {
                pictureInPictureToggle: true,
                volumePanel: {
                    inline: false
                }
            }
        });

        // Custom player event handlers
        player.on('play', function() {
            console.log('Video playing');
        });

        player.on('pause', function() {
            console.log('Video paused');
        });

        player.on('ended', function() {
            console.log('Video ended');
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Space bar for play/pause
            if (e.code === 'Space' && e.target.tagName !== 'INPUT' && e.target.tagName !== 'TEXTAREA') {
                e.preventDefault();
                if (player.paused()) {
                    player.play();
                } else {
                    player.pause();
                }
            }
            
            // Arrow keys for seeking
            if (e.code === 'ArrowLeft') {
                player.currentTime(player.currentTime() - 5);
            }
            if (e.code === 'ArrowRight') {
                player.currentTime(player.currentTime() + 5);
            }
            
            // Arrow up/down for volume
            if (e.code === 'ArrowUp') {
                e.preventDefault();
                player.volume(Math.min(1, player.volume() + 0.1));
            }
            if (e.code === 'ArrowDown') {
                e.preventDefault();
                player.volume(Math.max(0, player.volume() - 0.1));
            }
            
            // F for fullscreen
            if (e.code === 'KeyF') {
                if (player.isFullscreen()) {
                    player.exitFullscreen();
                } else {
                    player.requestFullscreen();
                }
            }
            
            // M for mute
            if (e.code === 'KeyM') {
                player.muted(!player.muted());
            }
        });
    </script>

    <!-- Mobile Bottom Menu -->
    <nav class="md:hidden fixed bottom-0 left-0 right-0 bg-background-dark/95 backdrop-blur-lg border-t border-white/10 z-50">
        <div class="flex items-center justify-around py-3">
            <a href="{{ url_for('home') }}" class="flex flex-col items-center gap-1 px-4 py-2 text-white/60">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 256 256" xmlns="http://www.w3.org/2000/svg">
                    <path d="M219.31,108.68l-80-80a16,16,0,0,0-22.62,0l-80,80A15.87,15.87,0,0,0,32,120v96a8,8,0,0,0,8,8h64a8,8,0,0,0,8-8V160h32v56a8,8,0,0,0,8,8h64a8,8,0,0,0,8-8V120A15.87,15.87,0,0,0,219.31,108.68Z"></path>
                </svg>
                <span class="text-xs font-medium">Home</span>
            </a>
            
            <a href="{{ url_for('upload_page') }}" class="flex flex-col items-center gap-1 px-4 py-2 text-white/60">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 256 256" xmlns="http://www.w3.org/2000/svg">
                    <path d="M213.66,82.34l-56-56A8,8,0,0,0,152,24H56A16,16,0,0,0,40,40V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V88A8,8,0,0,0,213.66,82.34ZM160,51.31,188.69,80H160ZM200,216H56V40h88V88a8,8,0,0,0,8,8h48V216Zm-42.34-61.66a8,8,0,0,1,0,11.32l-24,24a8,8,0,0,1-11.32,0l-24-24a8,8,0,0,1,11.32-11.32L120,164.69V120a8,8,0,0,1,16,0v44.69l10.34-10.35A8,8,0,0,1,157.66,154.34Z"></path>
                </svg>
                <span class="text-xs font-medium">Upload</span>
            </a>
            
            <a href="{{ url_for('videos') }}" class="flex flex-col items-center gap-1 px-4 py-2 text-white/60">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 256 256" xmlns="http://www.w3.org/2000/svg">
                    <path d="M216,40H40A16,16,0,0,0,24,56V168a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V56A16,16,0,0,0,216,40ZM40,56H216V168H40ZM208,208H48a8,8,0,0,1,0-16H208a8,8,0,0,1,0,16Z"></path>
                </svg>
                <span class="text-xs font-medium">Browse</span>
            </a>
            
            <a href="{{ url_for('dashboard') }}" class="flex flex-col items-center gap-1 px-4 py-2 text-white/60">
                <div class="size-6 rounded-full bg-primary flex items-center justify-center text-white text-xs font-bold">
                    {{ session.username[0].upper() }}
                </div>
                <span class="text-xs font-medium">My Videos</span>
            </a>
        </div>
    </nav>
</body>
</html>